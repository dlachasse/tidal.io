<% environment.context_class.instance_eval { include ActionView::Helpers::JavaScriptHelper } %>
<% environment.context_class.instance_eval { include HtmlCompressor } %>
<% files = Rails.application.assets.each_file.select { |file| file.to_s.end_with?('.html') } %>
<% @output = ""; compressor = HtmlCompressor::Compressor.new %>
<% files.each do |html| %>
	<% @output << "\"#{html.basename}\", \"#{compressor.compress(escape_javascript(File.read(html)))}\"" %>
<% end %>
angular.module("<%= ENV['ANGULAR_TEMPLATES_MODULE_NAME'] %>").run(["$templateCache", function($templateCache) {
  $templateCache.put(<%= @output %>);
}]);
